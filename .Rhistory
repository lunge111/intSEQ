simu.res50 <- simuComp(res, ntime = 20,nsamp = 50,null = T,lambda2 = 1000000)
plotComp(simu.res50)
simu.res50 <- simuComp(res, ntime = 20,nsamp = 50,null = T,lambda2 = 1000000)
library(intSEQ)
simu.res50 <- simuComp(res, ntime = 20,nsamp = 50,null = T,lambda2 = 1000000)
plotComp(simu.res50)
plotComp(simu.res50)
simu.res50 <- simuComp(res, ntime = 20,nsamp = 30,null = T,lambda2 = 1000000)
library(intSEQ)
simu.res50 <- simuComp(res, ntime = 20,nsamp = 30,null = T,lambda2 = 1000000)
plotComp(simu.res50)
library(intSEQ)
simu.res50 <- simuComp(res, ntime = 20,nsamp = 50,null = T)
simu.res35 <- simuComp(res, ntime = 20,nsamp = 35,null = T)
simu.res40 <- simuComp(res, ntime = 20,nsamp = 40,null = T)
simu.res45 <- simuComp(res, ntime = 20,nsamp = 45,null = T)
plotComp(simu.res35)
plotComp(simu.res40)
plotComp(simu.res45)
simu.res35 <- simuComp(res, ntime = 50,nsamp = 35,null = T)
plotComp(simu.res35)
library(intSEQ)
simu.res35 <- simuComp(res, ntime = 20,nsamp = 35,null = T)
simu.res40 <- simuComp(res, ntime = 20,nsamp = 40,null = T)
simu.res45 <- simuComp(res, ntime = 20,nsamp = 45,null = T)
plotComp(simu.res35)
plotComp(simu.res40)
plotComp(simu.res45)
simu.res35 <- simuComp(res, ntime = 20,nsamp = 35,null = T)
simu.res35 <- simuComp(res, ntime = 20,nsamp = 35,null = T)
plotComp(simu.res35)
plotComp(simu.res40)
plotComp(simu.res45)
load("F:/recount2/T-All/T-all.rda")
dim(count.data)
min(rowMeans(count.data))
library(edgeR)
library(intSEQ)
make.matrix<- function(nb.mean,disp, nsamp,ngene){
dat = rnbinom(nsamp*ngene*2,mu=nb.mean,size=1/disp)
matrix(dat,ncol=nsamp*2)
}
add.zero<-function(mat,p){
pmat = matrix(rbinom(length(mat),size=1, prob= p), ncol = ncol(mat))
mat[pmat==1]=0
mat
}
getpLM <- function(y,x){
fit = lm(y~x)
s=summary(fit)
s$coefficients[2,4]
}
tran1 <-  function(y,c1)
{
ty <- log(y+sqrt(y^2+y/c1)+1/(2*c1))
return(ty)
}
pp<-function(nb.mean, disp,nsamp,ngene,z.prob){
m = make.matrix(nb.mean, disp,nsamp,ngene)
m2 <- add.zero(m,z.prob)
cond = factor(rep(0:1,each=nsamp))
v1 = tran1(m, disp)
v2= tran1(m2,disp)
p1=apply(v1, 1, getpLM, x = cond)
p2=apply(v2, 1, getpLM, x = cond)
cbind(p1,p2)
}
p1=pp(80,5,40,100000,0.90)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(80,5,40,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(80,5,40,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(80,5,40,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(80,.1,40,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p2=pp(80,.1,40,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p3=pp(80,.1,40,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p3=pp(80,.1,40,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
p4=pp(80,.1,40,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,2]),type="b",col=2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(800,.1,40,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p2=pp(800,.1,40,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p3=pp(800,.1,40,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p4=pp(800,.1,40,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
tran1(400,1)
tran1(0,1)
p1=pp(800,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p2=pp(800,.1,10,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p3=pp(800,.1,10,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p4=pp(800,.1,10,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p1=pp(8,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p2=pp(8,.1,10,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p3=pp(8,.1,10,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p3[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p4=pp(8,.1,10,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
p4=pp(8,.1,10,100000,0.5)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
488/80
388/60
p4=pp(8,.1,10,100000,0.3)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
?ebayes
pp<-function(nb.mean, disp,nsamp,ngene,z.prob){
m = make.matrix(nb.mean, disp,nsamp,ngene)
m2 <- add.zero(m,z.prob)
cond = factor(rep(0:1,each=nsamp))
v1 = tran1(m, disp)
v2= tran1(m2,disp)
p1=apply(v1, 1, getpLM, x = cond)
p2=apply(v2, 1, getpLM, x = cond)
cbind(p1,p2)
}
pp2<-function(nb.mean, disp,nsamp,ngene,z.prob){
m = make.matrix(nb.mean, disp,nsamp,ngene)
m2 <- add.zero(m,z.prob)
cond = factor(rep(0:1,each=nsamp))
design = model.matrix(~cond)
m = DGEList(m)
m2 = DGEList(m2)
v <- voom(m, design, plot = FALSE)
fit <- lmFit(v, design)
p1 <- eBayes(fit)$p.value[,2]
v2 <- voom(m2, design, plot = FALSE)
fit2 <- lmFit(v2, design)
p2 <- eBayes(fit2)$p.value[,2]
cbind(p1,p2)
}
p1=pp2(8,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t1=pp2(8,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t2=pp2(8,.1,10,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t3=pp2(8,.1,10,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t4=pp2(8,.1,10,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t5=pp2(8,.1,10,100000,0.3)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t5[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t5[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t1=pp2(80,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t2=pp2(80,.1,10,100000,0.9)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t3=pp2(80,.1,10,100000,0.8)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t4=pp2(80,.1,10,100000,0.7)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t4[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t4[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
t5=pp2(80,.1,10,100000,0.3)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t5[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t5[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
load("F:/recount2/T-All/T-all2.rda")
?NBsimu
mle1
pp3<-function(mle,nsamp,z.prob){
m = NBsimu(mle1 = mle1,null=T, nsamp = 8,norm = F)
m2 <- add.zero(m,z.prob)
cond = factor(rep(0:1,each=nsamp))
design = model.matrix(~cond)
m = DGEList(m)
m2 = DGEList(m2)
v <- voom(m, design, plot = FALSE)
fit <- lmFit(v, design)
p1 <- eBayes(fit)$p.value[,2]
v2 <- voom(m2, design, plot = FALSE)
fit2 <- lmFit(v2, design)
p2 <- eBayes(fit2)$p.value[,2]
cbind(p1,p2)
}
pp2<- <-function(mle,nsamp,nsim,z.prob){
P=NULL
for(i in 1:nsim){
pp=pp3(mle,nsamp,z.prob)
P=rbind(P,pp)
}
P
}
pp2<- function(mle,nsamp,nsim,z.prob){
P=NULL
for(i in 1:nsim){
pp=pp3(mle,nsamp,z.prob)
P=rbind(P,pp)
}
P
}
t1=pp2(mle1,8,10,.95)
pp3<-function(mle,nsamp,z.prob){
m = NBsimu(mle1 = mle1,null=T, nsamp = 8,norm = F)$cd
m2 <- add.zero(m,z.prob)
cond = factor(rep(0:1,each=nsamp))
design = model.matrix(~cond)
m = DGEList(m)
m2 = DGEList(m2)
v <- voom(m, design, plot = FALSE)
fit <- lmFit(v, design)
p1 <- eBayes(fit)$p.value[,2]
v2 <- voom(m2, design, plot = FALSE)
fit2 <- lmFit(v2, design)
p2 <- eBayes(fit2)$p.value[,2]
cbind(p1,p2)
}
t1=pp2(mle1,8,10,.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1)
abline(a=0,b=1,lty=1,lty="2")
t1=pp2(mle1,8,10,.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=1,lty="2")
abline(a=0,b=1,lty=2)
p1=pp(8,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
legend("topleft",legend = c("ordinary","filter"),lty=1,col=1:2)
p1=pp(8,.1,10,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",xlab="levels",ylab = "FPR", main = "trans, p=0.95")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
legend("topleft",legend = c("ordinary","filter"),lty=1,col=1:2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",type="b",xlab="levels",ylab = "FPR", main = "trans, p=0.95")
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",xlab="levels",ylab = "FPR", main = "trans, p=0.95")
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",xlab="levels",ylab = "FPR", main = "voom, p=0.95")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
legend("topleft",legend = c("ordinary","filter"),lty=1,col=1:2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t3[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,1]),log='xy', ylim=c(1e-6,0.5),type="b")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t2[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
p1=pp(8,.1,20,100000,0.95)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",xlab="levels",ylab = "FPR", main = "trans, p=0.95")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(p1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
legend("topleft",legend = c("ordinary","filter"),lty=1,col=1:2)
plot(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,1]),log='xy', ylim=c(1e-6,0.5),type="b",xlab="levels",ylab = "FPR", main = "voom, p=0.95")
points(c(1e-06, 1e-05, 1e-04, 0.001, 0.01, 0.05, 0.1), pcut(t1[,2]),type="b",col=2)
abline(a=0,b=1,lty=2)
c(0,0,0,0,0,400)
a=c(0,0,0,0,0,400)
tran1(a)
tran1(a,1)
tran1(a,1.5)
tran1(a,.5)
library(intSEQ)
data("count.data")
data("condition")
res = intSEQ(count.data,condition)
pp=res$parameters
dim(pp)
m = rowMean(pp[,1:129])
m = rowMeans(pp[,1:129])
dis = pp[,130]
plot(m,dis,log="x")
plot(m,dis,log="xy")
plot(m,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "log row mean", ylab = "log dispersion")
fit = loess(dis~m)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "log row mean", ylab = "log dispersion")
fit = loess(dis~m)
mdf=data.frame("x"=log(m+0.5))
mdf=data.frame("x"=log(m+0.5))
predict(fit,mdf)
yy=predict(fit,mdf)
line(m+0.5,yy)
points(line(m+0.5,yy))
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
line(m+0.5,yy)
lines(m+0.5,yy)
lines(log(m+0.5),yy)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
lines(log(m+0.5),log(yy))
yy
sum(yy>0)
plot(log(m+0.5),log(yy))
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
?leoss
?loess
fit = loess(dis~m,span=1)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=1)
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
plot(log(m+0.5),log(yy))
lines(log(m+0.5),log(yy),col=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
lines(log(m+0.5),log(yy),col=2)
lines(log(m+0.5),log(yy),col=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=.4)
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
lines(log(m+0.5),log(yy),col=2)
lines(m+0.5,log(yy),col=2)
lines(m+0.5,yy,col=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=.4)
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
lines(m+0.5,yy,col=2)
points(m+0.5,yy,col=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=.4)
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
points(m+0.5,yy,col=2)
points(m+0.5,yy,col=2,type = 2.lwd=2)
points(m+0.5,yy,col=2,type = 2,lwd=2)
points(m+0.5,yy,col=2,type = "l",lwd=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
points(m+0.5,yy,col=2,type = "l",lwd=2)
points(m+0.5,yy,col=2,type = "b",lwd=2)
points(m+0.5,yy,col=2,lwd=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=.4)
mdf=data.frame("x"=log(m+0.5))
yy=predict(fit,mdf)
points(m+0.5,yy,col=2,lwd=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=.4)
yy=predict(fit)
lines(yy,col=2)
fit = loess(dis~m,span=1)
yy=predict(fit)
lines(yy,col=2)
plot(m+0.5,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m,span=1)
yy=predict(fit)
lines(yy,col=2)
plot(m,dis,log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(dis~m)
yy=predict(fit)
lines(yy,col=2)
fit = loess(log(dis)~log(m))
yy=predict(fit)
lines(yy,col=2)
plot(log(m),log(dis),log="xy",main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m))
yy=predict(fit)
lines(yy,col=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 1)
yy=predict(fit)
lines(yy,col=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
yy=predict(fit)
lines(yy,col=2)
fit = loess(log(dis)~log(m),span = 0.4,lwd=2)
lines(yy,col=2,lwd=2)
yy
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
yy=predict(fit)
lines(yy,col=2,lwd=2)
yy=
lines(predict(fit),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
lines(predict(fit),col=2,lwd=2)
plot(m,dis,main = "Row mean v.s. Dispersion",log="xy",xlab = "started log row mean", ylab = "log dispersion")
xl=
lines(predict(fit),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
xl=
lines(predict(fit),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
xl= seq(min(log(m)),mmax(log(m)),length(10000))
xl= seq(min(log(m)),max(log(m)),length(10000))
lines(predict(fit,xl),col=2,lwd=2)
min(log(m))
predict(fit,xl)
xl= seq(min(log(m)),max(log(m)),length=10000)
lines(predict(fit,xl),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
xl= seq(min(log(m)),max(log(m)),length=10000)
lines(predict(fit,xl),col=2,lwd=2)
predict(fit,xl)
points(predict(fit,xl),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
xl= seq(min(log(m)),max(log(m)),length=10000)
points(predict(fit,xl),col=2,lwd=2)
predict(fit,xl)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 0.4)
xl= seq(min(log(m)),max(log(m)),length=10000)
lines(xl,predict(fit,xl),col=2,lwd=2)
sum(yy>0)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 1)
xl= seq(min(log(m)),max(log(m)),length=10000)
lines(xl,predict(fit,xl),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
fit = loess(log(dis)~log(m),span = 1)
xl= seq(min(log(m)),max(log(m)),length=10000)
lines(xl,predict(fit,xl),col=2,lwd=2)
plot(log(m),log(dis),main = "Row mean v.s. Dispersion",xlab = "started log row mean", ylab = "log dispersion")
